generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Post {
  id        Int      @id @default(autoincrement())
  title     String
  content   String?
  createdAt DateTime @default(now())
}

model Account {
  account_id  BigInt @id @default(autoincrement())
  employee_id BigInt @unique
  role_id     BigInt

  username      String    @unique @db.VarChar(50)
  password_hash String    @db.VarChar(255)
  last_login    DateTime? @db.Timestamptz

  // üîë relations
  employee Employee @relation(fields: [employee_id], references: [employee_id])
  role     Role     @relation(fields: [role_id], references: [role_id])

  @@map("accounts")
}

model Employee {
  employee_id BigInt @id

  full_name     String   @db.VarChar(100)
  gender        String   @db.VarChar(10)
  date_of_birth DateTime @db.Date

  phone   String? @db.VarChar(20)
  email   String? @unique @db.VarChar(100)
  address String? @db.VarChar(255)

  store_id    BigInt
  position_id BigInt

  hire_date DateTime @db.Date
  status    String   @db.VarChar(20)

  avatar String? @db.VarChar(255)

  created_at DateTime @default(now()) @db.Timestamptz
  updated_at DateTime @default(now()) @db.Timestamptz

  // üîÅ 1‚Äì1 ng∆∞·ª£c l·∫°i
  account     Account?
  attendances Attendance[]

  @@map("employees")
}

model Role {
  role_id     BigInt  @id
  role_name   String  @unique @db.VarChar(50)
  description String? @db.VarChar(255)

  // üîÅ 1‚Äìn
  accounts Account[]

  @@map("roles")
}

model Attendance {
  attendance_id BigInt    @id @default(autoincrement())
  employee_id   BigInt
  work_date     DateTime  @db.Date
  check_in      DateTime? @db.Timestamptz
  check_out     DateTime? @db.Timestamptz

  employee Employee @relation(fields: [employee_id], references: [employee_id])

  @@unique([employee_id, work_date])
  @@map("attendances")
}
